<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jiubo.sam.dao.PaymentDao">

    <insert id="addPayment" useGeneratedKeys="true" keyProperty="paymentId">
        INSERT INTO PAYMENT (PATIENT_ID,PAYSERVICE_ID,RECEIVABLE, ACTUALPAYMENT, BEGTIME, ENDTIME, PAYMENTTIME, UPDATETIME,ISUSE)
        VALUES
            (#{patientId},#{payserviceId},#{receivable}, #{actualpayment}, #{begtime}, #{endtime}, #{paymenttime}, #{updatetime},
            <if test="isuse=='true'">
                1
            </if>
            <if test="isuse=='false'">
                0
            </if>
            )
    </insert>

    <!--    收费信息汇总查询-->
    <select id="queryGatherPayment" resultType="java.util.Map">
        ${sql}
    </select>

    <!--    根据患者id查询交费信息-->
    <select id="queryPaymentByPatientId" resultType="com.jiubo.sam.bean.PaymentBean">
        SELECT A.PAYMENT_ID, A.PATIENT_ID, A.PAYSERVICE_ID, A.RECEIVABLE, A.ACTUALPAYMENT,
               A.BEGTIME, A.ENDTIME, A.PAYMENTTIME, A.UPDATETIME, A.ISUSE,B.NAME PAYSERVICENAME
        FROM PAYMENT A,PAYSERVICE B
        WHERE A.PAYSERVICE_ID = B.PAYSERVICE_ID AND A.PATIENT_ID = #{patientId}
    </select>
</mapper>
